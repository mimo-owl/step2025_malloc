# STEP2025 WEEK7 Documentation
Author: Mimo Shirasaka

## Challenge 1
### Instruction
best fit を実装する
### Solution
Program: malloc.c

### Results
実装したmallocの性能(Time, Utilization)
----------------------------------------------------
Challenge \#1    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|              10 =>            1568
Utilization [%] |              70 =>              70
----------------------------------------------------
Challenge \#2    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|               7 =>            1071
Utilization [%] |              40 =>              40
----------------------------------------------------
Challenge \#3    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|             125 =>            1293
Utilization [%] |               9 =>              51
----------------------------------------------------
Challenge \#4    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|           20779 =>           11092
Utilization [%] |              15 =>              72
----------------------------------------------------
Challenge \#5    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|           14626 =>            6424
Utilization [%] |              15 =>              75
----------------------------------------------------

Challenge done!
Please copy & paste the following data in the score sheet!
1568,70,1071,40,1293,51,11092,72,6424,75,

## Challenge 2
### Insruction
worst fit を実装する

### Solution
Program: malloc.c

### Results
6分ほど待ってみても、challenge #2 までしか結果が出なかった（最終的に下記の結果が出ました）
→worst fit にすると実行時間がだいぶ長くなることがわかった。また、使用率がとても低くなることもわかった。

実装したmallocの性能(Time, Utilization)
----------------------------------------------------
Challenge #1    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|              12 =>          339329
Utilization [%] |              70 =>               4
----------------------------------------------------
Challenge #2    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|               6 =>           66126
Utilization [%] |              40 =>               2
----------------------------------------------------
Challenge #3    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|             124 =>           77401
Utilization [%] |               9 =>               3
----------------------------------------------------
Challenge #4    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|           22665 =>         1036917
Utilization [%] |              15 =>               7
----------------------------------------------------
Challenge #5    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|           23662 =>         1030374
Utilization [%] |              15 =>               7


## Challenge 3
### Instruction
Free list bin を実装する

### Solution
Program: malloc.c

### Results
実装したmallocの性能(Time, Utilization)

----------------------------------------------------
Challenge #1    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|               9 =>            1349
Utilization [%] |              70 =>              70
----------------------------------------------------
Challenge #2    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|               6 =>            1061
Utilization [%] |              40 =>              40
----------------------------------------------------
Challenge #3    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|             124 =>            1241
Utilization [%] |               9 =>              51
----------------------------------------------------
Challenge #4    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|           20888 =>             267
Utilization [%] |              15 =>              72
----------------------------------------------------
Challenge #5    |   simple_malloc =>       my_malloc
--------------- + --------------- => ---------------
       Time [ms]|           14245 =>             794
Utilization [%] |              15 =>              75
----------------------------------------------------


## 工夫と考察

### １：メモリ付与に関して
best-fitとworst-fitを実装し、 `make run` して求まった結果を比較することで、１回１回のメモリの使い方を効率化するか否かが大きく全体のメモリ使用効率に影響するだけでなく、計算時間にも影響する事がわかった（worst-fitの時の方が実行時間が長くかかった）。

### ２：空きメモリへのアクセスに関して
さらに、空きメモリへのアクセス方法の改善として、free list binを実装する際、先にデータが要求しているメモリサイズを`printf`で調べてみた。その結果、全体的に、1~1000までの容量のものが多く、1000~2000までのものも一定数あるが、2000以上のものは少なそうだという事がわかった。そこでbinの分け方の工夫として、全部で12個用意し、以下のように分配した。

bin0~bin9: 1~1000を100ずつ分ける（i.e., bin0=1~100, bin1=101~200, ..., bin9=901~1000）
bin10: 1000~2000: １つのbinに入れる
bin11: 2001以上の容量全て入れる

その結果、計算時間を大幅に短縮でき、具体的には、best-fitにおける free list bin の有無の比較で、
Challenge4 --> 41倍
Challenge5 --> 8.09倍
の短縮となった。スコアボードを記入するときに他のメンバーのものも見てみたところ、best-fit だけの人の間ではスコアが大きく変わらないのに対し、free list bin を組み合わせて実装している人の間では計算時間に大きな差があることに気づき、このことから、binの分け方の工夫が計算時間を大きく左右する要因になっているのではないか、と考察した。

## 感想
free list bin を実装したら、格段と計算時間が速くなったのが実行しながら実感でき、面白かったです！


## メモ
free list bin の実装：数や分け方を工夫、二部探索　p.138, 139 を参考にして実装する
